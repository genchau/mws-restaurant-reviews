(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(t,e,n){"use strict";var a=n(0);function r(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"restaurantImgUrl",value:function(t){var e=t.photograph;return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"./images/".concat(e):"".concat(this.BASE_URL,"/images/").concat(e)}},{key:"restaurantUrl",value:function(t){var e=t.id;return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"./restaurant.html?id=".concat(e):"".concat(this.BASE_URL,"/restaurant.html?id=").concat(e)}},{key:"fetchRestaurants",value:function(){return fetch(this.DB_URL).then(function(t){if(!t.ok)throw Error("Unable to retrieve restaurant data");return t.json()}).then(function(t){return t.restaurants}).catch(console.error)}},{key:"fetchRestaurant",value:function(t){return this.fetchRestaurants().then(function(e){return e.filter(function(e){return e.id===t})[0]})}},{key:"calculateAverageReview",value:function(t){return this.fetchRestaurant(t).then(function(t){var e=t.reviews;return e?Math.max(Math.round(e.reduce(function(t,e){return t+e.rating},0)/e.length*10)/10,1).toFixed(1):0}).catch(console.error)}},{key:"BASE_URL",get:function(){return"".concat(a.a.HOST).concat(a.a.PORT&&":".concat(a.a.PORT))}},{key:"DB_URL",get:function(){return"./data/restaurants.json"}}],(n=null)&&r(e.prototype,n),o&&r(e,o),t}();e.a=o},function(t,e,n){"use strict";var a=n(0);e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=document.createElement("script");e.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=".concat(a.a.MAPS_KEY,"&libraries=places&callback=initMap")),e.setAttribute("async",""),e.setAttribute("defer",""),t.appendChild(e)}},function(t,e,n){"use strict";function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||document.getElementById("map");this._options=Object.assign({},{zoom:12,center:{lat:40.722216,lng:-73.987501},disableDefaultUI:!0,scrollwheel:!1},n),this._googleMap=new google.maps.Map(e,this._options),this.markers=[],this.lastMarker=null}var e,n,r;return e=t,(n=[{key:"addMarkers",value:function(t,e){var n=this,a=new google.maps.LatLngBounds;this.markers=t.map(function(t){var r=n.addMarkerWithInfoWindow(t,e);return a.extend(r.position),r}),this.markers.length>0&&(this.GoogleMap.fitBounds(a),this.GoogleMap.setZoom(this._options.zoom))}},{key:"addMarker",value:function(t){var e=t.position,n=t.content;return new google.maps.Marker({animation:google.maps.Animation.DROP,map:this.GoogleMap,position:e,content:n})}},{key:"addMarkerWithInfoWindow",value:function(t,e){var n=this,a=this.addMarker(t),r=new google.maps.InfoWindow;return a.addListener("click",function(){n.lastMarker&&n.lastMarker.close(),n.lastMarker=r,n.GoogleMap.panTo(a.getPosition()),n.GoogleMap.panBy(0,-150),e(r,a)}),a}},{key:"resetMarkers",value:function(){this.markers.forEach(function(t,e){t.setMap(null),google.maps.event.clearInstanceListeners(t)}),this.markers=[]}},{key:"GoogleMap",get:function(){return this._googleMap}}])&&a(e.prototype,n),r&&a(e,r),t}();e.a=r},,,function(t,e,n){"use strict";n.r(e);n(0);var a=n(1),r=n(3),o=n(2);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}self.initMap=function(){c.loadMap()};var i=function(t,e){var n=document.createDocumentFragment(),a=document.createElement("option");e.forEach(function(t){var e=a.cloneNode();e.textContent=t,e.value=t,n.appendChild(e)}),t.appendChild(n)},c={map:null,restaurants:null,pageElements:{cuisineSelect:document.getElementById("cuisine"),filterForm:document.querySelector(".filters"),neighborhoodSelect:document.getElementById("neighborhood"),restaurantsList:document.querySelector(".restaurants-list"),restaurantResultCount:document.querySelector(".restaurant-count")},render:function(){var t=this;Object(o.a)(),a.a.fetchRestaurants().then(function(e){if(!e)throw Error("Restaurants could not be displayed");var n=t.pageElements,a=(n.mobileButtonBar,n.filterForm);t.restaurants=e,t.populateFilterForm(),t.populateRestaurantsList(),a.addEventListener("change",t.handleFilterUpdates.bind(t))}).catch(console.error)},populateFilterForm:function(){var t=s(new Set(this.restaurants.map(function(t){return t.neighborhood}))),e=s(new Set(this.restaurants.map(function(t){return t.cuisine_type}))),n=this.pageElements,a=n.neighborhoodSelect,r=n.cuisineSelect;i(a,t),i(r,e)},handleFilterUpdates:function(t){var e=this,n=this.pageElements,r=n.neighborhoodSelect,o=n.cuisineSelect,s=r[r.selectedIndex].value,i=o[o.selectedIndex].value;a.a.fetchRestaurants().then(function(t){if(!t)throw Error("Restaurants could not be displayed");t="all"!==i?t.filter(function(t){return t.cuisine_type===i}):t,t="all"!==s?t.filter(function(t){return t.neighborhood===s}):t,e.restaurants=t,e.populateRestaurantsList()}).catch(console.error),t.stopPropagation()},populateRestaurantsList:function(){if(this.restaurants){var t=this.pageElements,e=t.restaurantsList,n=t.restaurantResultCount,r=document.createDocumentFragment(),o=this.restaurants.length;this.restaurants.forEach(function(t){var e,n,o,s,i,c,u,l,d,p;r.appendChild((e=t,n=document.createElement("span"),o=document.createElement("li"),s=document.createElement("img"),i=document.createElement("div"),c=document.createElement("h2"),u=n.cloneNode(),l=document.createElement("address"),d=document.createElement("a"),p=n.cloneNode(),s.className="restaurant-item__image",s.src=a.a.restaurantImgUrl(e),s.setAttribute("alt",e.altText),i.className="restaurant-item__info",c.textContent=e.name,c.className="restaurant-item__title",u.textContent=e.neighborhood,u.className="restaurant-item__neighborhood",l.className="restaurant-item___address",l.textContent=e.address,p.className="restaurant-item__review",a.a.calculateAverageReview(e.id).then(function(t){p.textContent=t,p.setAttribute("aria-label","Average review"),i.append(c),i.append(u),i.append(l),c.append(p),i.append(d)}),d.textContent="Details",d.href=a.a.restaurantUrl(e),d.title="View additional details about ".concat(e.name),d.className="restaurant-item__detail-link",s.onload=function(){o.append(s),o.append(i)},o.classList.add("restaurants-list__item"),o))}),this.resetRestaurants(),e.appendChild(r),n.innerHTML='\n        Displaying <span class="restaurant-count__text">'.concat(o,"</span> \n        restaurant").concat(1===o?"":"s","\n      "),this.updateMap()}},resetRestaurants:function(){var t=this.pageElements,e=t.restaurantsList,n=t.restaurantResultCount;e.innerHTML="",n.innerHTML='Displaying <span class="restaurant-count__text">0</span> restaurants'},updateMap:function(){if(this.map){var t=this.restaurants.map(function(t){return{position:t.latlng,content:{address:t.address,cuisine:t.cuisine_type,photo:a.a.restaurantImgUrl(t),altText:t.altText,title:t.name,url:a.a.restaurantUrl(t)}}});this.resetMap(),this.map.addMarkers(t,this.handleMapMarkerClick)}},handleMapMarkerClick:function(t,e){var n=e.content,a=n.title,r=n.photo,o=n.altText,s=n.address,i=n.url;t.setContent('\n      <div class="infoWindow">\n        <img src="'.concat(r,'" alt="').concat(o,'" class="infoWindow__image">\n        <h2 class="infoWindow__title">').concat(a,'</h2>\n        <address class="infoWindow__address">').concat(s,'</address>\n        <a href="').concat(i,'" title="View more information about ').concat(a,'" class="infoWindow__link">View Details</a>\n      </div>\n    ')),t.open(e.map,e)},loadMap:function(){this.map=new r.a,this.restaurants&&this.updateMap()},resetMap:function(){this.map&&this.map.resetMarkers()}};e.default=c}]]);
//# sourceMappingURL=home.min.js.map