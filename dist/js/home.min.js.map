{"version":3,"sources":["webpack:///./src/js/utils/DBHelper.js","webpack:///./src/js/utils/loadGoogleMaps.js","webpack:///./src/js/utils/Map.js","webpack:///./src/styles/home.scss","webpack:///./src/styles/home.scss?10bd","webpack:///./src/js/controllers/IndexController.js"],"names":["DBHelper","photograph","_ref","arguments","length","undefined","concat","this","BASE_URL","id","_ref2","fetch","DB_URL","then","response","ok","Error","json","results","restaurants","catch","console","error","fetchRestaurants","filter","r","restaurantId","fetchRestaurant","_ref3","reviews","Math","max","round","reduce","a","c","rating","toFixed","_config__WEBPACK_IMPORTED_MODULE_0__","HOST","PORT","__webpack_exports__","node","document","body","script","createElement","setAttribute","MAPS_KEY","appendChild","Map","mount","options","callback","_classCallCheck","_options","Object","assign","zoom","center","lat","lng","disableDefaultUI","scrollwheel","element","getElementById","_googleMap","google","maps","markers","lastMarker","setTimeout","data","onClick","_this","bounds","LatLngBounds","map","item","marker","addMarkerWithInfoWindow","extend","position","GoogleMap","fitBounds","setZoom","content","Marker","animation","Animation","DROP","_this2","addMarker","infoWindow","InfoWindow","addListener","close","panTo","getPosition","panBy","forEach","i","setMap","event","clearInstanceListeners","module","exports","__webpack_require__","push","hmr","transform","insertInto","locals","self","initMap","IndexController","loadMap","populateSelectBox","selectEl","values","docFrag","createDocumentFragment","optionEl","value","option","cloneNode","textContent","pageElements","cuisineSelect","filterForm","querySelector","neighborhoodSelect","restaurantsList","restaurantResultCount","render","_utils_loadGoogleMaps__WEBPACK_IMPORTED_MODULE_3__","_utils_DBHelper__WEBPACK_IMPORTED_MODULE_1__","_this$pageElements","mobileButtonBar","populateFilterForm","populateRestaurantsList","addEventListener","handleFilterUpdates","bind","neighborhoods","Set","neighborhood","cuisines","cuisine_type","_this$pageElements2","_this$pageElements3","selectedIndex","cuisine","stopPropagation","_this$pageElements4","rCount","restaurant","span","li","image","name","address","more","avgReview","className","src","restaurantImgUrl","altText","calculateAverageReview","score","append","href","restaurantUrl","title","onload","classList","add","resetRestaurants","innerHTML","updateMap","_this$pageElements5","latlng","photo","url","resetMap","addMarkers","handleMapMarkerClick","_marker$content","setContent","open","_utils_Map__WEBPACK_IMPORTED_MODULE_2__","resetMarkers"],"mappings":"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","file":"./js/home.min.js","sourcesContent":["import config from '../config';\n\nclass DBHelper {\n  static get BASE_URL() {\n    return `${config.HOST}${config.PORT && `:${config.PORT}`}`;\n  }\n\n  static get DB_URL(){\n    return `./data/restaurants.json`;\n  }\n\n  static restaurantImgUrl({ photograph }, relative = true) {\n    return (relative)\n     ? `./images/${photograph}`\n     : `${this.BASE_URL}/images/${photograph}`;\n  }\n\n  static restaurantUrl({ id }, relative = true) {\n    return (relative)\n     ? `./restaurant.html?id=${id}`\n     : `${this.BASE_URL}/restaurant.html?id=${id}`;\n  }\n\n  static fetchRestaurants() {\n    return fetch(this.DB_URL)\n      .then(response => {\n        if(!response.ok) {\n          throw Error('Unable to retrieve restaurant data');\n        }\n        \n        return response.json();\n      })\n      .then(results => results.restaurants)\n      .catch(console.error);\n  }\n\n  static fetchRestaurant(id) {\n    return this.fetchRestaurants()\n      .then(restaurants => restaurants.filter(r => r.id === id)[0]);\n  }\n\n  static calculateAverageReview(restaurantId) {\n    return this.fetchRestaurant(restaurantId)\n      .then(({ reviews }) => {\n        if (!reviews) return 0;\n\n        // Stand back, we're going to try mathematics!\n        return Math.max(\n                Math.round(\n                  (reviews.reduce((a, c) => a + c.rating, 0) / reviews.length) * 10\n                ) / 10, 1\n              ).toFixed(1);\n      })\n      .catch(console.error);\n  }\n};\n\nexport default DBHelper;\n","import config from '../config';\n\n/**\n * Appends the Google Maps API script at the end of the document.body \n * or the specified node, if provided.\n * @param {HTMLElement} node \n */\nconst loadGoogleMaps = (node = document.body) => {\n  const script = document.createElement('script');\n\n  script.setAttribute('src', `https://maps.googleapis.com/maps/api/js?key=${config.MAPS_KEY}&callback=initMap`);\n  script.setAttribute('async', '');\n  script.setAttribute('defer', '');\n  node.appendChild(script);\n};\n\nexport default loadGoogleMaps;\n","class Map {\n  constructor(mount, options, callback) {\n    const defaultOptions = { \n      zoom: 12, \n      center: {\n        lat: 40.722216,\n        lng: -73.987501\n      }, \n      disableDefaultUI: true,\n      scrollwheel: false,\n    };\n    \n    this._options = Object.assign({}, defaultOptions, options);\n    this.element = mount || document.getElementById('map');\n\n    this._googleMap = new google.maps.Map(this.element, this._options);\n    this.markers = [];\n    this.lastMarker = null;\n\n    // Dirty, dirty hack to delay a callback\n    // Presumably the map will have loaded within \n    // a second?\n    if (callback) {\n      setTimeout(callback, 1000);\n    }\n  }\n\n  get GoogleMap() {\n    return this._googleMap;\n  }\n\n  addMarkers(data, onClick) {\n    let bounds = new google.maps.LatLngBounds();\n    this.markers = data.map(item => {\n      let marker = this.addMarkerWithInfoWindow(item, onClick);\n      bounds.extend(marker.position);\n\n      return marker;\n    });\n\n    // Fit the map to the boundaries of the markers\n    if (this.markers.length > 0) {\n      this.GoogleMap.fitBounds(bounds);\n      this.GoogleMap.setZoom(this._options.zoom);\n    }\n  }\n\n  addMarker({ position, content }) {\n    return new google.maps.Marker({\n      animation: google.maps.Animation.DROP,\n      map: this.GoogleMap,\n      position,\n      content,\n    });\n  }\n\n  addMarkerWithInfoWindow(item, onClick) {\n    // Create a new marker and define marker properties\n    const marker = this.addMarker(item);\n\n    // Create a new infowindow\n    const infoWindow = new google.maps.InfoWindow();\n\n    marker.addListener('click', () => {\n      // Close the most recently opened infowindow\n      this.lastMarker && this.lastMarker.close();\n\n      // Reset the last clicked infowindow to this one\n      this.lastMarker = infoWindow;\n\n      // Pan the map to the center of the clicked marker\n      this.GoogleMap.panTo(marker.getPosition());\n\n      // Pan the map downward to accommodate the info window\n      this.GoogleMap.panBy(0, -150);\n\n      // Show the infowindow\n      onClick(infoWindow, marker);\n    });\n\n    return marker;\n  }\n\n  resetMarkers() {\n    this.markers.forEach((marker, i) => {\n      marker.setMap(null);\n      google.maps.event.clearInstanceListeners(marker);\n    });\n\n    this.markers = [];\n  }\n}\n\nexport default Map;\n","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".restaurant-filters{display:flex;flex-direction:column;background:hsla(0,0%,93%,.25);padding:.8rem}.restaurant-filters .filter-title{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.filters{display:flex;flex-direction:column}.filters .row{display:flex;padding:.4rem}.filters label{font-weight:700;flex:1 0 30%}.filters select{border:1px solid rgba(51,51,51,.35);color:#333;flex:1 0 45%}.filters select:active,.filters select:focus{background:#9affdc;border-color:#009a65;color:#333;outline:none}@media screen and (min-width:550px){.filters{flex-direction:row}.filters .row{padding:.8rem 0;margin-right:1.06667rem}.filters label{flex:1 0 auto}.filters select{margin:0 1.06667rem}}.map-container{border:1px inset rgba(51,51,51,.35);display:flex;flex:1 0 auto}.map{background-color:#e1e1e1;flex:1 0 auto;height:auto;min-height:40rem;opacity:1;transition:opacity 1s ease}.map .map__loading{color:rgba(51,51,51,.85);display:block;font-weight:700;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.infoWindow{max-width:50vmin}.infoWindow .infoWindow__title{width:100%}.infoWindow .infoWindow__image{max-width:100%}.infoWindow .infoWindow__address{font-size:1.4rem;margin-bottom:1.06667rem}.infoWindow .infoWindow__link{color:#b22200;font-weight:700;text-decoration:underline}@media screen and (min-width:550px){.infoWindow{max-width:30vmin}}.restaurants{height:auto;margin-bottom:1.6rem;padding:1.06667rem}.restaurants .restaurant-count{background:hsla(0,0%,93%,.5);border:1px solid hsla(0,0%,68%,.25);border-radius:.3rem;padding:.8rem;margin-bottom:1.6rem}.restaurants .restaurant-count .restaurant-count__text{font-weight:700}.restaurants-list{display:grid;grid-row-gap:3rem;grid-column-gap:3rem;grid-template-columns:repeat(auto-fill,minmax(26.2rem,1fr))}.restaurants-list__item{background:hsla(0,0%,93%,.65);border:1px solid rgba(51,51,51,.25);border-radius:2.4rem 0 2.4rem 0;box-shadow:0 0 1rem rgba(51,51,51,.5);display:flex;flex-direction:column;min-height:30rem;position:relative}.restaurants-list__item .restaurant-item__image{border-radius:2.4rem 0 0 0}.restaurants-list__item .restaurant-item__info{background:#eee;border-top:1px solid rgba(51,51,51,.75);border-radius:0 0 2.4rem 0;color:#333;display:flex;flex-direction:column;flex:1;justify-content:space-evenly;padding:.8rem 1.06667rem}.restaurants-list__item .restaurant-item__title{color:#333;font-size:2rem;text-align:center;text-transform:uppercase}.restaurants-list__item .restaurant-item___address,.restaurants-list__item .restaurant-item__neighborhood{color:#484848;font-size:1.4rem}.restaurants-list__item .restaurant-item__review{display:block;font-size:1.6rem;font-weight:400}.restaurants-list__item .restaurant-item__review:before{color:orange;content:\\\"\\\\2605\\\";padding-right:.5rem;position:relative;top:-.1rem}.restaurants-list__item .restaurant-item__detail-link{background:#b22200;border:1px solid rgba(0,0,0,.25);border-radius:.3rem;color:#fff;display:block;margin:1.6rem auto .8rem;padding:.8rem;text-align:center;transition:all .3s ease;width:50%}.restaurants-list__item .restaurant-item__detail-link:active,.restaurants-list__item .restaurant-item__detail-link:focus,.restaurants-list__item .restaurant-item__detail-link:hover{background:#ff3100;box-shadow:0 0 1.06667rem rgba(51,51,51,.9);outline:none}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--6-2!../../node_modules/sass-loader/lib/loader.js!./home.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js??ref--6-2!../../node_modules/sass-loader/lib/loader.js!./home.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js??ref--6-2!../../node_modules/sass-loader/lib/loader.js!./home.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import config from '../config';\nimport DBHelper from '../utils/DBHelper';\nimport Map from '../utils/Map';\nimport loadGoogleMaps from '../utils/loadGoogleMaps';\n\nimport \"../../styles/home.scss\";\n\n/**\n * Unfortunately we have to attach this function to the global scope.\n * This is a limitation of Google Maps.\n */\nself.initMap = () => {\n  IndexController.loadMap();\n};\n\n/**\n * Utility function to populate a select box with values.\n */\nconst populateSelectBox = (selectEl, values) => {\n  // Create a document fragment and option element\n  const docFrag = document.createDocumentFragment();\n  const optionEl = document.createElement('option');\n\n  // Add an option for each value\n  values.forEach(value => {\n    // Clone the option element\n    let option = optionEl.cloneNode();\n\n    // Set the textContent and value\n    option.textContent = value;\n    option.value = value;\n\n    // Append the option to the document fragment\n    docFrag.appendChild(option);\n  });\n\n  // Append the document fragment to the select box\n  selectEl.appendChild(docFrag);\n};\n\n/**\n * Generates the html for one restaurant list item.\n */\nconst createRestaurant = restaurant => {\n  // Create the necessary elements for later\n  const span = document.createElement('span');\n  const li = document.createElement('li');\n  const image = document.createElement('img');\n  const body = document.createElement('div');\n  const name = document.createElement('h2');\n  const neighborhood = span.cloneNode();\n  const address = document.createElement('address');\n  const more = document.createElement('a');\n  const avgReview = span.cloneNode();\n\n  // Setup the image\n  image.className = 'restaurant-item__image';\n  image.src = DBHelper.restaurantImgUrl(restaurant);\n  image.setAttribute('alt', restaurant.altText);\n\n  // Content body\n  body.className = 'restaurant-item__info';\n\n  // Restaurant title\n  name.textContent = restaurant.name;\n  name.className = 'restaurant-item__title';\n\n  // Restaurant neighborhood\n  neighborhood.textContent = restaurant.neighborhood;\n  neighborhood.className = 'restaurant-item__neighborhood';\n\n  // Restaurant address\n  address.className = 'restaurant-item___address';\n  address.textContent = restaurant.address;\n\n  // Average Review\n  avgReview.className = 'restaurant-item__review';\n  DBHelper.calculateAverageReview(restaurant.id).then(score => {\n    avgReview.textContent = score;\n    avgReview.setAttribute('aria-label', 'Average review');\n\n    // Append items to the content body\n    body.append(name);\n    body.append(neighborhood);\n    body.append(address);\n    name.append(avgReview);\n    body.append(more);\n  });\n\n  // View More button\n  more.textContent = 'Details';\n  more.href = DBHelper.restaurantUrl(restaurant);\n  more.title = `View additional details about ${restaurant.name}`;\n  more.className = 'restaurant-item__detail-link';\n\n  // Once the image has loaded, append all elements to the list item\n  image.onload = () => {\n    li.append(image);\n    li.append(body);\n  };\n\n  // Give the list item a class and return it\n  li.classList.add('restaurants-list__item');\n\n  return li;\n};\n\nconst IndexController = {\n  map: null,\n  restaurants: null,\n  pageElements: {\n    cuisineSelect: document.getElementById('cuisine'),\n    filterForm: document.querySelector('.filters'),\n    neighborhoodSelect: document.getElementById('neighborhood'),\n    restaurantsList: document.querySelector('.restaurants-list'),\n    restaurantResultCount: document.querySelector('.restaurant-count'),\n  },\n  \n  render() {\n    loadGoogleMaps();\n    \n    DBHelper.fetchRestaurants()\n      .then(restaurants => {\n        if (!restaurants) throw Error('Restaurants could not be displayed');\n\n        const { mobileButtonBar, filterForm } = this.pageElements;\n\n        // Save restaurants for later\n        this.restaurants = restaurants;\n\n        // Populate filters and display the restaurants\n        this.populateFilterForm();\n        this.populateRestaurantsList();\n\n        // Attach event listeners for the mobile view\n        filterForm.addEventListener('change', this.handleFilterUpdates.bind(this));\n      })\n      .catch(console.error);\n  },\n\n  populateFilterForm() {\n    const neighborhoods = [...new Set(this.restaurants.map(r => r.neighborhood))];\n    const cuisines = [...new Set(this.restaurants.map(r => r.cuisine_type))];\n    const { neighborhoodSelect, cuisineSelect } = this.pageElements;\n\n    populateSelectBox(neighborhoodSelect, neighborhoods);\n    populateSelectBox(cuisineSelect, cuisines);\n  },\n\n  handleFilterUpdates(event) {\n    const { neighborhoodSelect, cuisineSelect } = this.pageElements;\n    const neighborhood = neighborhoodSelect[neighborhoodSelect.selectedIndex].value;\n    const cuisine = cuisineSelect[cuisineSelect.selectedIndex].value;\n\n    DBHelper.fetchRestaurants()\n      .then(restaurants => {\n        if (!restaurants) throw Error('Restaurants could not be displayed');\n\n        restaurants = (cuisine !== 'all') ? \n          restaurants.filter(r => r.cuisine_type === cuisine) : \n          restaurants;\n        \n        restaurants = (neighborhood !== 'all') ?\n          restaurants.filter(r => r.neighborhood === neighborhood) :\n          restaurants;\n        \n        this.restaurants = restaurants;\n        this.populateRestaurantsList();\n      })\n      .catch(console.error);\n    \n    event.stopPropagation();\n  },\n\n  populateRestaurantsList() {\n    if (this.restaurants) {\n      const { restaurantsList, restaurantResultCount } = this.pageElements;\n      const docFrag = document.createDocumentFragment();\n      const rCount = this.restaurants.length;\n\n      this.restaurants.forEach(r => {\n        docFrag.appendChild(createRestaurant(r));\n      });\n\n      this.resetRestaurants();\n\n      restaurantsList.appendChild(docFrag);\n      restaurantResultCount.innerHTML = `\n        Displaying <span class=\"restaurant-count__text\">${rCount}</span> \n        restaurant${rCount === 1 ? '' : 's'}\n      `;\n\n      this.updateMap();\n    }\n  },\n\n  resetRestaurants() {\n    const { restaurantsList, restaurantResultCount } = this.pageElements;\n    restaurantsList.innerHTML = '';\n    restaurantResultCount.innerHTML = 'Displaying <span class=\"restaurant-count__text\">0</span> restaurants';\n  },\n\n  updateMap() {\n    if (!this.map) {\n      return;\n    }\n\n    const markers = this.restaurants.map(r => ({\n      position: r.latlng,\n      content: {\n        address: r.address,\n        cuisine: r.cuisine_type,\n        photo: DBHelper.restaurantImgUrl(r),\n        altText: r.altText,\n        title: r.name,\n        url: DBHelper.restaurantUrl(r),\n      }\n    }));\n\n    this.resetMap();\n    this.map.addMarkers(markers, this.handleMapMarkerClick);\n  },\n\n  handleMapMarkerClick(infoWindow, marker) {\n    const {\n      content: { \n        title, \n        photo, \n        altText,\n        address, \n        url \n      }\n    } = marker;\n  \n    // Set content of the info window\n    infoWindow.setContent(`\n      <div class=\"infoWindow\">\n        <img src=\"${photo}\" alt=\"${altText}\" class=\"infoWindow__image\">\n        <h2 class=\"infoWindow__title\">${title}</h2>\n        <address class=\"infoWindow__address\">${address}</address>\n        <a href=\"${url}\" title=\"View more information about ${title}\" class=\"infoWindow__link\">View Details</a>\n      </div>\n    `);\n  \n    // Open the info window\n    infoWindow.open(marker.map, marker);\n  },\n\n  loadMap() {\n    this.map = new Map(null, null, () => {\n      // Add a title to the map iframe\n      const mapFrame = document.querySelector('.map iframe');\n      mapFrame.title = \"Restaurant Locations\";\n    });\n    this.restaurants && this.updateMap();\n  },\n\n  resetMap() {\n    this.map && this.map.resetMarkers();\n  }\n};\n\nexport default IndexController;\n"],"sourceRoot":""}