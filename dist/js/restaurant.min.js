(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t,n){"use strict";var a=n(1);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"restaurantImgUrl",value:function(e){var t=e.photograph;return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"./images/".concat(t):"".concat(this.BASE_URL,"/images/").concat(t)}},{key:"restaurantUrl",value:function(e){var t=e.id;return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"./restaurant.html?id=".concat(t):"".concat(this.BASE_URL,"/restaurant.html?id=").concat(t)}},{key:"fetchRestaurants",value:function(){return fetch(this.DB_URL).then(function(e){if(!e.ok)throw Error("Unable to retrieve restaurant data");return e.json()}).then(function(e){return e.restaurants}).catch(console.error)}},{key:"fetchRestaurant",value:function(e){return this.fetchRestaurants().then(function(t){return t.filter(function(t){return t.id===e})[0]})}},{key:"calculateAverageReview",value:function(e){return this.fetchRestaurant(e).then(function(e){var t=e.reviews;return t?Math.max(Math.round(t.reduce(function(e,t){return e+t.rating},0)/t.length*10)/10,1).toFixed(1):0}).catch(console.error)}},{key:"BASE_URL",get:function(){return"".concat(a.a.HOST).concat(a.a.PORT&&":".concat(a.a.PORT))}},{key:"DB_URL",get:function(){return"./data/restaurants.json"}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();t.a=o},,function(e,t,n){"use strict";var a=n(1);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=document.createElement("script");t.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=".concat(a.a.MAPS_KEY,"&libraries=places&callback=initMap")),t.setAttribute("async",""),t.setAttribute("defer",""),e.appendChild(t)}},function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this._options=Object.assign({},{zoom:12,center:{lat:40.722216,lng:-73.987501},disableDefaultUI:!0,scrollwheel:!1},n),this.element=t||document.getElementById("map"),this._googleMap=new google.maps.Map(this.element,this._options),this.markers=[],this.lastMarker=null,a&&google.maps.event.addDomListenerOnce(window,"load",a)}var t,n,r;return t=e,(n=[{key:"addMarkers",value:function(e,t){var n=this,a=new google.maps.LatLngBounds;this.markers=e.map(function(e){var r=n.addMarkerWithInfoWindow(e,t);return a.extend(r.position),r}),this.markers.length>0&&(this.GoogleMap.fitBounds(a),this.GoogleMap.setZoom(this._options.zoom))}},{key:"addMarker",value:function(e){var t=e.position,n=e.content;return new google.maps.Marker({animation:google.maps.Animation.DROP,map:this.GoogleMap,position:t,content:n})}},{key:"addMarkerWithInfoWindow",value:function(e,t){var n=this,a=this.addMarker(e),r=new google.maps.InfoWindow;return a.addListener("click",function(){n.lastMarker&&n.lastMarker.close(),n.lastMarker=r,n.GoogleMap.panTo(a.getPosition()),n.GoogleMap.panBy(0,-150),t(r,a)}),a}},{key:"resetMarkers",value:function(){this.markers.forEach(function(e,t){e.setMap(null),google.maps.event.clearInstanceListeners(e)}),this.markers=[]}},{key:"GoogleMap",get:function(){return this._googleMap}}])&&a(t.prototype,n),r&&a(t,r),e}();t.a=r},function(e,t,n){"use strict";n.r(t);n(1);var a=n(0),r=n(3),o=n(2),i=function(e){if(e){if(URLSearchParams)return new URLSearchParams(location.search).get(e);e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]".concat(e,"=([^&#]*)")).exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}};self.initMap=function(){u.loadMap()};var s=function(){var e=document.createElement("span"),t=document.createDocumentFragment();e.textContent="â˜…";for(var n=5;n>0;n--){var a=e.cloneNode(!0);t.appendChild(a)}return t},c=function(e){var t=document.createElement("div"),n=t.cloneNode(),a=t.cloneNode(),r=t.cloneNode();return n.className="star-rating__container",a.className="star-rating__top",a.style.width="".concat(e,"%"),a.appendChild(s()),n.appendChild(a),r.className="star-rating__bottom",r.appendChild(s()),n.appendChild(r),n},u={map:null,restaurant:null,pageElements:{breadcrumbs:document.querySelector(".breadcrumbs__nav-list"),restaurantContainer:document.querySelector(".restaurant"),restaurantName:document.querySelector(".restaurant__name"),restaurantCuisine:document.querySelector(".restaurant__cuisine"),restaurantHoursToday:document.querySelector(".hours-today__text"),restaurantAddress:document.querySelector(".restaurant__address"),restaurantNeighborhood:document.querySelector(".restaurant__neighborhood"),restaurantStarRating:document.querySelector(".restaurant__star-rating"),restaurantHoursContainer:document.querySelector(".restaurant__hours-container"),restaurantImageContainer:document.querySelector(".restaurant__image-container"),reviewsContainer:document.querySelector(".restaurant__reviews-container")},render:function(){var e=this,t=+i("id");t?a.a.fetchRestaurant(t).then(function(n){n?(Object(o.a)(),e.restaurant=n,document.title+=" | ".concat(e.restaurant.name),e.fillBreadcrumb(),e.renderRestaurant()):console.error("Unable to retrieve a restaurant with the ID ".concat(t))}).catch(console.error):console.error("The restaurant ID could not be located")},renderRestaurant:function(){this.generateImage(),this.populateHeader(),this.generateAverageRating(),this.populateAddress(),this.populateDetails(),this.renderReviews()},populateHeader:function(){var e=this.pageElements,t=e.restaurantName,n=e.restaurantCuisine,a=e.restaurantHoursToday,r=this.restaurant,o=r.name,i=r.cuisine_type,s=r.operating_hours,c=Object.keys(s)[(new Date).getDay()-1];t.textContent=o,n.textContent=i,a.textContent=s[c]},generateImage:function(){var e=this.pageElements.restaurantImageContainer,t=this.restaurant.altText,n=document.createElement("img");n.src=a.a.restaurantImgUrl(this.restaurant),n.alt=t,n.className="restaurant__image",n.onload=function(t){e.appendChild(n)}},generateAverageRating:function(){var e=this.pageElements.restaurantStarRating,t=this.restaurant.reviews,n=function(e){return e.reduce(function(e,t){return e+t.rating},0)/(5*e.length)*100}(t),a=document.createElement("a");e.appendChild(c(n)),a.setAttribute("href","#reviews"),a.setAttribute("title","Skip to customer reviews"),a.className="star-rating__link",a.textContent="".concat(t.length," reviews"),e.appendChild(a)},populateAddress:function(){var e=this.pageElements,t=e.restaurantAddress,n=e.restaurantNeighborhood,a=this.restaurant,r=a.address,o=a.neighborhood;t.textContent=r,n.textContent=o},populateDetails:function(){var e=this.pageElements.restaurantHoursContainer,t=this.restaurant.operating_hours;e.appendChild(function(e){var t=document.createDocumentFragment(),n=document.createElement("table"),a=document.createElement("tr"),r=document.createElement("thead"),o=a.cloneNode(),i=document.createElement("tbody"),s=a.cloneNode(),c=document.createElement("th"),u=document.createElement("td");for(var l in n.className="restaurant__hours",r.appendChild(o),i.appendChild(s),e){var d=c.cloneNode(),m=u.cloneNode();d.textContent=l,m.innerHTML=e[l].includes(",")?e[l].replace(", ","<br>"):e[l],m.setAttribute("data-th",l),o.appendChild(d),s.appendChild(m)}return n.appendChild(r),n.appendChild(i),t.appendChild(n),t}(t))},renderReviews:function(){var e=this.restaurant.reviews,t=this.pageElements.reviewsContainer,n=document.createDocumentFragment();if(!e){var a=document.createElement("p");return a.textContent="".concat(this.restaurant.name," does not have any reviews"),a.className="restaurant-reviews__empty",void t.appendChild(a)}var r=document.createElement("ul");r.className="restaurant__reviews",e.forEach(function(e){n.appendChild(function(e){var t=document.createElement("li"),n=document.createElement("div"),a=document.createElement("p"),r=n.cloneNode(),o=n.cloneNode(),i=a.cloneNode(),s=n.cloneNode(),u=a.cloneNode(),l=a.cloneNode();return t.className="restaurant__review",r.className="review__top",o.className="review__body",i.textContent=e.name,i.className="review__username",r.appendChild(i),s.className="star-rating",s.setAttribute("aria-label","User rating: ".concat(e.rating)),s.appendChild(c(e.rating/5*100)),r.appendChild(s),u.textContent=e.date,u.className="review__date",l.innerHTML=e.comments,l.className="review__comment",o.appendChild(u),o.appendChild(l),t.appendChild(r),t.appendChild(o),t}(e))}),r.appendChild(n),t.appendChild(r)},fillBreadcrumb:function(){var e=this.pageElements.breadcrumbs,t=document.createElement("li");t.textContent=this.restaurant.name,t.classList.add("breadcrumbs__nav-item"),t.setAttribute("aria-current","page"),e.appendChild(t)},loadMap:function(){this.map=new r.a(null,{zoom:16,center:this.restaurant.latlng,scrollwheel:!1},function(){document.querySelector(".map iframe").title="Restaurant Location"}),this.restaurant&&this.updateMap()},updateMap:function(){this.map&&this.map.addMarker({position:this.restaurant.latlng,content:{}})}};t.default=u}]]);
//# sourceMappingURL=restaurant.min.js.map